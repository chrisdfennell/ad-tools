{% extends 'base.html' %}
{% block title %}gMSA: {{ gmsa.cn }}{% endblock %}

{% block breadcrumb %}
<a href="{{ url_for('dashboard.index') }}" class="text-decoration-none text-muted">Dashboard</a>
<span class="mx-2">/</span>
<a href="{{ url_for('gmsa.index') }}" class="text-decoration-none text-muted">gMSA Accounts</a>
<span class="mx-2">/</span>
<span>{{ gmsa.cn }}</span>
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h4 class="mb-1"><i class="fas fa-cogs me-2"></i>{{ gmsa.cn }}</h4>
        <small class="text-muted">{{ gmsa.dn }}</small>
    </div>
    <span class="badge bg-{{ 'success' if gmsa.status == 'enabled' else 'danger' }} fs-6">{{ gmsa.status }}</span>
</div>

<div class="row g-4">
    <div class="col-lg-5">
        <div class="card">
            <div class="card-header"><i class="fas fa-info-circle me-1"></i>Account Details</div>
            <div class="card-body">
                <div class="detail-section">
                    <div class="detail-row">
                        <div class="detail-label">SAM Account</div>
                        <div class="detail-value"><code>{{ gmsa.sam }}</code></div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">DNS Host Name</div>
                        <div class="detail-value">{{ gmsa.dns_name or '---' }}</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Description</div>
                        <div class="detail-value">{{ gmsa.description or '---' }}</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Password Interval</div>
                        <div class="detail-value">{{ gmsa.pwd_interval }} days</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Created</div>
                        <div class="detail-value">{{ gmsa.when_created }}</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Modified</div>
                        <div class="detail-value">{{ gmsa.when_changed }}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-lg-7">
        <div class="card mb-4">
            <div class="card-header"><i class="fas fa-tags me-1"></i>Service Principal Names <span class="badge bg-secondary">{{ gmsa.spns|length }}</span></div>
            <div class="card-body">
                {% if gmsa.spns %}
                <ul class="list-group list-group-flush">
                    {% for spn in gmsa.spns %}
                    <li class="list-group-item"><code>{{ spn }}</code></li>
                    {% endfor %}
                </ul>
                {% else %}
                <p class="text-muted mb-0">No SPNs registered.</p>
                {% endif %}
            </div>
        </div>

        <div class="card">
            <div class="card-header"><i class="fas fa-layer-group me-1"></i>Group Membership <span class="badge bg-secondary">{{ gmsa.member_of|length }}</span></div>
            <div class="card-body">
                {% if gmsa.member_of %}
                <ul class="list-group list-group-flush">
                    {% for g in gmsa.member_of %}
                    <li class="list-group-item"><small class="text-break">{{ g }}</small></li>
                    {% endfor %}
                </ul>
                {% else %}
                <p class="text-muted mb-0">Not a member of any groups.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
